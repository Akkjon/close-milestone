{"version":3,"file":"index.js","sources":["../dist-src/get-app-authentication.js","../dist-src/cache.js","../dist-src/to-token-authentication.js","../dist-src/get-installation-authentication.js","../dist-src/get-oauth-authentication.js","../dist-src/auth.js","../dist-src/requires-app-auth.js","../dist-src/hook.js","../dist-src/version.js","../dist-src/index.js"],"sourcesContent":["import { githubAppJwt } from \"universal-github-app-jwt\";\nexport async function getAppAuthentication({ appId, privateKey, timeDifference, }) {\n    const appAuthentication = await githubAppJwt({\n        id: +appId,\n        privateKey,\n        now: timeDifference && Math.floor(Date.now() / 1000) + timeDifference,\n    });\n    return {\n        type: \"app\",\n        token: appAuthentication.token,\n        appId: appAuthentication.appId,\n        expiresAt: new Date(appAuthentication.expiration * 1000).toISOString(),\n    };\n}\n","// https://github.com/isaacs/node-lru-cache#readme\nimport LRU from \"lru-cache\";\nexport function getCache() {\n    return new LRU({\n        // cache max. 15000 tokens, that will use less than 10mb memory\n        max: 15000,\n        // Cache for 1 minute less than GitHub expiry\n        maxAge: 1000 * 60 * 59,\n    });\n}\nexport async function get(cache, options) {\n    const cacheKey = optionsToCacheKey(options);\n    const result = await cache.get(cacheKey);\n    if (!result) {\n        return;\n    }\n    const [token, createdAt, expiresAt, repositorySelection, permissionsString, singleFileName,] = result.split(\"|\");\n    const permissions = options.permissions ||\n        permissionsString.split(/,/).reduce((permissions, string) => {\n            if (/!$/.test(string)) {\n                permissions[string.slice(0, -1)] = \"write\";\n            }\n            else {\n                permissions[string] = \"read\";\n            }\n            return permissions;\n        }, {});\n    return {\n        token,\n        createdAt,\n        expiresAt,\n        permissions,\n        repositoryIds: options.repositoryIds,\n        singleFileName,\n        repositorySelection: repositorySelection,\n    };\n}\nexport async function set(cache, options, data) {\n    const key = optionsToCacheKey(options);\n    const permissionsString = options.permissions\n        ? \"\"\n        : Object.keys(data.permissions)\n            .map((name) => `${name}${data.permissions[name] === \"write\" ? \"!\" : \"\"}`)\n            .join(\",\");\n    const value = [\n        data.token,\n        data.createdAt,\n        data.expiresAt,\n        data.repositorySelection,\n        permissionsString,\n        data.singleFileName,\n    ].join(\"|\");\n    await cache.set(key, value);\n}\nfunction optionsToCacheKey({ installationId, permissions = {}, repositoryIds = [], }) {\n    const permissionsString = Object.keys(permissions)\n        .sort()\n        .map((name) => (permissions[name] === \"read\" ? name : `${name}!`))\n        .join(\",\");\n    const repositoryIdsString = repositoryIds.sort().join(\",\");\n    return [installationId, repositoryIdsString, permissionsString]\n        .filter(Boolean)\n        .join(\"|\");\n}\n","export function toTokenAuthentication({ installationId, token, createdAt, expiresAt, repositorySelection, permissions, repositoryIds, singleFileName, }) {\n    return Object.assign({\n        type: \"token\",\n        tokenType: \"installation\",\n        token,\n        installationId,\n        permissions,\n        createdAt,\n        expiresAt,\n        repositorySelection,\n    }, repositoryIds ? { repositoryIds } : null, singleFileName ? { singleFileName } : null);\n}\n","import { get, set } from \"./cache\";\nimport { getAppAuthentication } from \"./get-app-authentication\";\nimport { toTokenAuthentication } from \"./to-token-authentication\";\nexport async function getInstallationAuthentication(state, options, customRequest) {\n    const installationId = Number(options.installationId || state.installationId);\n    if (!installationId) {\n        throw new Error(\"[@octokit/auth-app] installationId option is required for installation authentication.\");\n    }\n    if (options.factory) {\n        const { type, factory, ...factoryAuthOptions } = options;\n        // @ts-ignore if `options.factory` is set, the return type for `auth()` should be `Promise<ReturnType<options.factory>>`\n        return factory(Object.assign({}, state, factoryAuthOptions));\n    }\n    const optionsWithInstallationTokenFromState = Object.assign({ installationId }, options);\n    if (!options.refresh) {\n        const result = await get(state.cache, optionsWithInstallationTokenFromState);\n        if (result) {\n            const { token, createdAt, expiresAt, permissions, repositoryIds, singleFileName, repositorySelection, } = result;\n            return toTokenAuthentication({\n                installationId,\n                token,\n                createdAt,\n                expiresAt,\n                permissions,\n                repositorySelection,\n                repositoryIds,\n                singleFileName,\n            });\n        }\n    }\n    const appAuthentication = await getAppAuthentication(state);\n    const request = customRequest || state.request;\n    const { data: { token, expires_at: expiresAt, repositories, permissions, \n    // @ts-ignore\n    repository_selection: repositorySelection, \n    // @ts-ignore\n    single_file: singleFileName, }, } = await request(\"POST /app/installations/{installation_id}/access_tokens\", {\n        installation_id: installationId,\n        repository_ids: options.repositoryIds,\n        permissions: options.permissions,\n        mediaType: {\n            previews: [\"machine-man\"],\n        },\n        headers: {\n            authorization: `bearer ${appAuthentication.token}`,\n        },\n    });\n    const repositoryIds = repositories\n        ? repositories.map((r) => r.id)\n        : void 0;\n    const createdAt = new Date().toISOString();\n    await set(state.cache, optionsWithInstallationTokenFromState, {\n        token,\n        createdAt,\n        expiresAt,\n        repositorySelection,\n        permissions,\n        repositoryIds,\n        singleFileName,\n    });\n    return toTokenAuthentication({\n        installationId,\n        token,\n        createdAt,\n        expiresAt,\n        repositorySelection,\n        permissions,\n        repositoryIds,\n        singleFileName,\n    });\n}\n","import { RequestError } from \"@octokit/request-error\";\nexport async function getOAuthAuthentication(state, options, customRequest) {\n    const request = customRequest || state.request;\n    // The \"/login/oauth/access_token\" is not part of the REST API hosted on api.github.com,\n    // instead itâ€™s using the github.com domain.\n    const route = /^https:\\/\\/(api\\.)?github\\.com$/.test(state.request.endpoint.DEFAULTS.baseUrl)\n        ? \"POST https://github.com/login/oauth/access_token\"\n        : `POST ${state.request.endpoint.DEFAULTS.baseUrl.replace(\"/api/v3\", \"/login/oauth/access_token\")}`;\n    const parameters = {\n        headers: {\n            accept: `application/json`,\n        },\n        client_id: state.clientId,\n        client_secret: state.clientSecret,\n        code: options.code,\n        state: options.state,\n        redirect_uri: options.redirectUrl,\n    };\n    const response = await request(route, parameters);\n    if (response.data.error !== undefined) {\n        throw new RequestError(`${response.data.error_description} (${response.data.error})`, response.status, {\n            headers: response.headers,\n            request: request.endpoint(route, parameters),\n        });\n    }\n    const { data: { access_token: token }, } = response;\n    return {\n        type: \"token\",\n        tokenType: \"oauth\",\n        token,\n    };\n}\n","import { getAppAuthentication } from \"./get-app-authentication\";\nimport { getInstallationAuthentication } from \"./get-installation-authentication\";\nimport { getOAuthAuthentication } from \"./get-oauth-authentication\";\nexport async function auth(state, options) {\n    const { type } = options;\n    switch (type) {\n        case \"app\":\n            return getAppAuthentication(state);\n        case \"installation\":\n            return getInstallationAuthentication(state, options);\n        case \"oauth\":\n            return getOAuthAuthentication(state, options);\n        default:\n            throw new Error(`Invalid auth type: ${type}`);\n    }\n}\n","const PATHS = [\n    \"/app\",\n    \"/app/hook/config\",\n    \"/app/installations\",\n    \"/app/installations/{installation_id}\",\n    \"/app/installations/{installation_id}/access_tokens\",\n    \"/app/installations/{installation_id}/suspended\",\n    \"/marketplace_listing/accounts/{account_id}\",\n    \"/marketplace_listing/plan\",\n    \"/marketplace_listing/plans\",\n    \"/marketplace_listing/plans/{plan_id}/accounts\",\n    \"/marketplace_listing/stubbed/accounts/{account_id}\",\n    \"/marketplace_listing/stubbed/plan\",\n    \"/marketplace_listing/stubbed/plans\",\n    \"/marketplace_listing/stubbed/plans/{plan_id}/accounts\",\n    \"/orgs/{org}/installation\",\n    \"/repos/{owner}/{repo}/installation\",\n    \"/users/{username}/installation\",\n];\n// CREDIT: Simon Grondin (https://github.com/SGrondin)\n// https://github.com/octokit/plugin-throttling.js/blob/45c5d7f13b8af448a9dbca468d9c9150a73b3948/lib/route-matcher.js\nfunction routeMatcher(paths) {\n    // EXAMPLE. For the following paths:\n    /* [\n        \"/orgs/{org}/invitations\",\n        \"/repos/{owner}/{repo}/collaborators/{username}\"\n    ] */\n    const regexes = paths.map((p) => p\n        .split(\"/\")\n        .map((c) => (c.startsWith(\"{\") ? \"(?:.+?)\" : c))\n        .join(\"/\"));\n    // 'regexes' would contain:\n    /* [\n        '/orgs/(?:.+?)/invitations',\n        '/repos/(?:.+?)/(?:.+?)/collaborators/(?:.+?)'\n    ] */\n    const regex = `^(?:${regexes.map((r) => `(?:${r})`).join(\"|\")})[^/]*$`;\n    // 'regex' would contain:\n    /*\n      ^(?:(?:\\/orgs\\/(?:.+?)\\/invitations)|(?:\\/repos\\/(?:.+?)\\/(?:.+?)\\/collaborators\\/(?:.+?)))[^\\/]*$\n  \n      It may look scary, but paste it into https://www.debuggex.com/\n      and it will make a lot more sense!\n    */\n    return new RegExp(regex, \"i\");\n}\nconst REGEX = routeMatcher(PATHS);\nexport function requiresAppAuth(url) {\n    return !!url && REGEX.test(url);\n}\n","import { getAppAuthentication } from \"./get-app-authentication\";\nimport { getInstallationAuthentication } from \"./get-installation-authentication\";\nimport { requiresAppAuth } from \"./requires-app-auth\";\nconst FIVE_SECONDS_IN_MS = 5 * 1000;\nfunction isNotTimeSkewError(error) {\n    return !(error.message.match(/'Expiration time' claim \\('exp'\\) must be a numeric value representing the future time at which the assertion expires/) ||\n        error.message.match(/'Issued at' claim \\('iat'\\) must be an Integer representing the time that the assertion was issued/));\n}\nexport async function hook(state, request, route, parameters) {\n    let endpoint = request.endpoint.merge(route, parameters);\n    if (requiresAppAuth(endpoint.url.replace(request.endpoint.DEFAULTS.baseUrl, \"\"))) {\n        const { token } = await getAppAuthentication(state);\n        endpoint.headers.authorization = `bearer ${token}`;\n        let response;\n        try {\n            response = await request(endpoint);\n        }\n        catch (error) {\n            // If there's an issue with the expiration, regenerate the token and try again.\n            // Otherwise rethrow the error for upstream handling.\n            if (isNotTimeSkewError(error)) {\n                throw error;\n            }\n            // If the date header is missing, we can't correct the system time skew.\n            // Throw the error to be handled upstream.\n            if (typeof error.headers.date === \"undefined\") {\n                throw error;\n            }\n            const diff = Math.floor((Date.parse(error.headers.date) - Date.parse(new Date().toString())) /\n                1000);\n            state.log.warn(error.message);\n            state.log.warn(`[@octokit/auth-app] GitHub API time and system time are different by ${diff} seconds. Retrying request with the difference accounted for.`);\n            const { token } = await getAppAuthentication({\n                ...state,\n                timeDifference: diff,\n            });\n            endpoint.headers.authorization = `bearer ${token}`;\n            return request(endpoint);\n        }\n        return response;\n    }\n    const { token, createdAt } = await getInstallationAuthentication(state, {}, request);\n    endpoint.headers.authorization = `token ${token}`;\n    return sendRequestWithRetries(state, request, endpoint, createdAt);\n}\n/**\n * Newly created tokens might not be accessible immediately after creation.\n * In case of a 401 response, we retry with an exponential delay until more\n * than five seconds pass since the creation of the token.\n *\n * @see https://github.com/octokit/auth-app.js/issues/65\n */\nasync function sendRequestWithRetries(state, request, options, createdAt, retries = 0) {\n    const timeSinceTokenCreationInMs = +new Date() - +new Date(createdAt);\n    try {\n        return await request(options);\n    }\n    catch (error) {\n        if (error.status !== 401) {\n            throw error;\n        }\n        if (timeSinceTokenCreationInMs >= FIVE_SECONDS_IN_MS) {\n            if (retries > 0) {\n                error.message = `After ${retries} retries within ${timeSinceTokenCreationInMs / 1000}s of creating the installation access token, the response remains 401. At this point, the cause may be an authentication problem or a system outage. Please check https://www.githubstatus.com for status information`;\n            }\n            throw error;\n        }\n        ++retries;\n        const awaitTime = retries * 1000;\n        state.log.warn(`[@octokit/auth-app] Retrying after 401 response to account for token replication delay (retry: ${retries}, wait: ${awaitTime / 1000}s)`);\n        await new Promise((resolve) => setTimeout(resolve, awaitTime));\n        return sendRequestWithRetries(state, request, options, createdAt, retries);\n    }\n}\n","export const VERSION = \"3.0.0\";\n","import { getUserAgent } from \"universal-user-agent\";\nimport { request } from \"@octokit/request\";\nimport { auth } from \"./auth\";\nimport { hook } from \"./hook\";\nimport { getCache } from \"./cache\";\nimport { VERSION } from \"./version\";\nexport const createAppAuth = function createAppAuth(options) {\n    const log = Object.assign({\n        warn: console.warn.bind(console),\n    }, options.log);\n    const state = Object.assign({\n        request: request.defaults({\n            headers: {\n                \"user-agent\": `octokit-auth-app.js/${VERSION} ${getUserAgent()}`,\n            },\n        }),\n        cache: getCache(),\n    }, options, options.installationId\n        ? { installationId: Number(options.installationId) }\n        : {}, {\n        log,\n    });\n    return Object.assign(auth.bind(null, state), {\n        hook: hook.bind(null, state),\n    });\n};\n"],"names":[],"mappings":"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"}