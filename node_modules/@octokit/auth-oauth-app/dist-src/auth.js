import btoa from "btoa-lite";
import { getOAuthAccessToken } from "./get-oauth-access-token";
export async function auth(state, authOptions) {
    if (authOptions.type === "token") {
        console.warn(`[@octokit/auth-oauth-app] "{type: 'token'}" is deprecated, use "{type: 'oauth-user'}" instead`);
    }
    if (authOptions.type === "token" || authOptions.type === "oauth-user") {
        const { token, scopes } = await getOAuthAccessToken(state, {
            auth: authOptions,
        });
        return {
            type: "token",
            token,
            tokenType: "oauth",
            scopes,
        };
    }
    return {
        type: "oauth-app",
        clientId: state.clientId,
        clientSecret: state.clientSecret,
        headers: {
            authorization: `basic ${btoa(`${state.clientId}:${state.clientSecret}`)}`,
        },
    };
}
